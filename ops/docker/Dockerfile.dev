# ------------------------------------------------------------
# Lightweight dev image with ALL hard deps installed
# ------------------------------------------------------------
FROM python:3.11-slim

# --- system libs your wheels occasionally need ----------------
RUN apt-get update -qq && \
    apt-get install -y --no-install-recommends build-essential git curl && \
    rm -rf /var/lib/apt/lists/*

WORKDIR /app
COPY requirements/requirements.txt /app/

#  ── real dependencies, no stubs ──────────────────────────────
RUN pip install --no-cache-dir -r requirements/requirements.txt \
    fastapi uvicorn[standard] redis python-arango==7.* \
    minio==7.* boto3  # boto3 pulled for MinIO tests

# Add the repo last → layer-cache friendly
COPY . /app
CMD ["bash"]
